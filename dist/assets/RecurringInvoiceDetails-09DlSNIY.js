import{c as C,d as D,a as R,r as j,j as e,L as F,R as f,F as A,V as d}from"./index-DMTdQ3St.js";import{u as E}from"./recurringInvoiceStore-Bk_4mFo2.js";import{F as S}from"./invoice-BGlX5FmL.js";import{a as n}from"./helpers-kgrKKtTT.js";import{A as T}from"./arrow-left-DgZupmuo.js";import{C as N}from"./check-circle-HEDH94gZ.js";import{X as y}from"./x-circle-CJq5NwBv.js";import{C as c}from"./calendar-CRwE0Pfy.js";import{P as q}from"./pen-square-DAdg6CDQ.js";import{T as L}from"./trash-2-B7Y99Ql6.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=C("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),G=()=>{var u,p;const{id:r}=D(),m=R(),{selectedRecurringInvoice:s,fetchRecurringInvoice:x,toggleRecurringInvoiceStatus:v,deleteRecurringInvoice:b,loading:w}=E(),[o,h]=j.useState(!1);j.useEffect(()=>{r&&x(r)},[r,x]);const _=async()=>{if(!(!r||!s))try{const t=s.status==="active"?"inactive":"active";await v(r,t),d.success(`Recurring invoice ${t==="active"?"activated":"deactivated"}`)}catch{d.error("Failed to update recurring invoice status")}},k=async()=>{if(!(!r||!s)&&window.confirm("Are you sure you want to delete this recurring invoice? This cannot be undone.")){h(!0);try{await b(r),d.success("Recurring invoice deleted successfully"),m("/recurring")}catch{d.error("Failed to delete recurring invoice")}finally{h(!1)}}},g=t=>{const l=S.find(I=>I.value===t);return l?l.label:t};if(w||!s)return e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});const i=s.clients||{},a=s.template_data;return e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{to:"/recurring",className:"mr-3 text-gray-500 hover:text-gray-700",children:e.jsx(T,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 truncate",children:s.title})]}),e.jsx("div",{className:"flex space-x-2 self-end sm:self-auto",children:e.jsxs("span",{className:`px-2.5 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full ${s.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[s.status==="active"?e.jsx(N,{className:"h-3.5 w-3.5 mr-1"}):e.jsx(y,{className:"h-3.5 w-3.5 mr-1"}),s.status.charAt(0).toUpperCase()+s.status.slice(1)]})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden mb-6",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recurring Invoice Information"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-y-2 gap-x-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(f,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"Frequency:"}),e.jsx("span",{className:"ml-2 font-medium",children:g(s.frequency)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(c,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"Start Date:"}),e.jsx("span",{className:"ml-2 font-medium",children:n(s.start_date)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(c,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"Next Invoice:"}),e.jsx("span",{className:"ml-2 font-medium",children:n(s.next_issue_date)})]}),s.end_date&&e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(c,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"End Date:"}),e.jsx("span",{className:"ml-2 font-medium",children:n(s.end_date)})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(A,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"Auto-send:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.auto_send?"Yes":"No"})]}),s.last_generated&&e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(c,{className:"mr-2 h-4 w-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-gray-500",children:"Last Generated:"}),e.jsx("span",{className:"ml-2 font-medium",children:n(s.last_generated)})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Client Information"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex items-start text-sm",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Client:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.name})]})}),i.company_name&&e.jsx("div",{className:"flex items-start text-sm",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Company:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.company_name})]})}),i.email&&e.jsx("div",{className:"flex items-start text-sm",children:e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("span",{className:"text-gray-500",children:"Email:"}),e.jsx("span",{className:"ml-2 font-medium truncate block",children:i.email})]})}),i.phone&&e.jsx("div",{className:"flex items-start text-sm",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("span",{className:"ml-2 font-medium",children:i.phone})]})})]})]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Invoice Template Details"}),e.jsx("div",{className:"mb-4 bg-gray-50 p-4 rounded-md",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Engagement Type"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:((u=a.invoice_data.engagement_type)==null?void 0:u.charAt(0).toUpperCase())+((p=a.invoice_data.engagement_type)==null?void 0:p.slice(1))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Currency"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.invoice_data.currency||"INR"})]}),a.invoice_data.tax_percentage&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tax Rate"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[a.invoice_data.tax_percentage,"%"]})]}),a.invoice_data.notes&&e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:a.invoice_data.notes})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Invoice Items"}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-md overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.invoice_items.map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:t.description||t.milestone_name}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-500",children:t.quantity}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-500",children:[a.invoice_data.currency==="USD"?"$":"₹",t.rate]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-medium text-gray-900",children:[a.invoice_data.currency==="USD"?"$":"₹",t.amount]})]},l))})]})})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200 bg-gray-50",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Schedule Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-md border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(c,{className:"h-4 w-4 text-blue-500 mr-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Next Invoice"})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Will be generated on ",n(s.next_issue_date)]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-md border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(f,{className:"h-4 w-4 text-green-500 mr-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Frequency"})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Repeats ",g(s.frequency)]})]}),s.end_date?e.jsxs("div",{className:"bg-white p-4 rounded-md border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(c,{className:"h-4 w-4 text-red-500 mr-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"End Date"})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Will end on ",n(s.end_date)]})]}):e.jsxs("div",{className:"bg-white p-4 rounded-md border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx($,{className:"h-4 w-4 text-amber-500 mr-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"No End Date"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Will continue until manually stopped"})]})]})]}),e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:_,className:`inline-flex items-center px-3 py-2 border rounded-md shadow-sm text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${s.status==="active"?"border-red-300 text-red-700 bg-red-50 hover:bg-red-100":"border-green-300 text-green-700 bg-green-50 hover:bg-green-100"}`,children:s.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-1.5 h-4 w-4"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-1.5 h-4 w-4"}),"Activate"]})}),e.jsxs("button",{type:"button",onClick:()=>m(`/recurring/edit/${r}`),className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(q,{className:"mr-1.5 h-4 w-4"}),"Edit"]}),e.jsx("button",{type:"button",onClick:k,disabled:o,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 mr-1.5 rounded-full border-2 border-red-700/30 border-t-red-700 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"mr-1.5 h-4 w-4"}),"Delete"]})})]})})]})]})};export{G as default};
