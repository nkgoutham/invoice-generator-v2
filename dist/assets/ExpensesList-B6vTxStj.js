import{c as V,r as i,j as e,L as v,D as T,F as K,u as $,V as A,R as Q}from"./index-DMTdQ3St.js";import{u as O}from"./expenseStore-BpTe1G7s.js";import{a as X,f as I}from"./helpers-kgrKKtTT.js";import{C as q}from"./calendar-CRwE0Pfy.js";import{T as M}from"./tag-ilgYDLAU.js";import{B as Z}from"./building-BwG9NAGn.js";import{C as ee}from"./check-circle-HEDH94gZ.js";import{E as se}from"./external-link-C3r03cik.js";import{P as z}from"./pen-square-DAdg6CDQ.js";import{T as Y}from"./trash-2-B7Y99Ql6.js";import{u as te}from"./index.esm-DkrFlcfS.js";import{P as U}from"./plus-circle-DtCdQUqZ.js";import{P as ae}from"./plus-C1YCJXOA.js";import{S as re}from"./search-DQGV9Rah.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=V("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=V("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),ie=({expense:s,onDelete:o})=>{var d,m;const[f,p]=i.useState(!1),g=async n=>{if(n.preventDefault(),n.stopPropagation(),window.confirm("Are you sure you want to delete this expense?")){p(!0);try{await o(s.id)}finally{p(!1)}}};return e.jsx("li",{className:"group",children:e.jsx(v,{to:`/expenses/${s.id}`,className:"block hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center mr-3",style:{backgroundColor:(d=s.category)!=null&&d.color?`${s.category.color}15`:"#f3f4f6",color:((m=s.category)==null?void 0:m.color)||"#6b7280"},children:e.jsx(T,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-xs sm:max-w-md",children:s.description}),e.jsxs("div",{className:"mt-1 flex items-center text-xs text-gray-500",children:[e.jsx(q,{className:"flex-shrink-0 mr-1.5 h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{children:X(s.date)}),s.category&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1.5",children:"•"}),e.jsx(M,{className:"flex-shrink-0 mr-1.5 h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{className:"inline-flex items-center",style:{color:s.category.color},children:s.category.name})]}),s.client&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1.5",children:"•"}),e.jsx(Z,{className:"flex-shrink-0 mr-1.5 h-3.5 w-3.5 text-gray-400"}),e.jsx("span",{children:s.client.company_name||s.client.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.is_billable&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(ee,{className:"mr-1 h-3 w-3"}),"Billable"]}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:I(s.amount,s.currency)})]})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[s.receipt_url&&e.jsxs("a",{href:s.receipt_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center mr-3 text-blue-600 hover:text-blue-800",onClick:n=>n.stopPropagation(),children:[e.jsx(K,{className:"flex-shrink-0 mr-1 h-3.5 w-3.5"}),"View Receipt",e.jsx(se,{className:"ml-0.5 h-3 w-3"})]}),s.payment_method&&e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(T,{className:"flex-shrink-0 mr-1 h-3.5 w-3.5 text-gray-400"}),s.payment_method.replace("_"," ").replace(/\b\w/g,n=>n.toUpperCase())]})]}),e.jsxs("div",{className:"mt-2 flex items-center text-xs sm:mt-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsxs(v,{to:`/expenses/${s.id}/edit`,className:"inline-flex items-center p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors duration-200",onClick:n=>n.stopPropagation(),children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs("button",{type:"button",className:"inline-flex items-center p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors duration-200",onClick:g,disabled:f,children:[f?e.jsx("div",{className:"h-4 w-4 border-2 border-red-600/30 border-t-red-600 rounded-full animate-spin"}):e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})]})]})})})},oe=()=>{const{user:s}=$(),{categories:o,createCategory:f,updateCategory:p,deleteCategory:g,fetchCategories:d,loading:m}=O(),[n,u]=i.useState(null),[C,h]=i.useState(null),{register:b,handleSubmit:c,reset:k,setValue:x,formState:{errors:N}}=te({defaultValues:{name:"",description:"",color:"#3B82F6"}}),j=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#F97316","#14B8A6","#6B7280"];i.useEffect(()=>{s&&d(s.id)},[s,d]);const B=async t=>{if(s)try{n?(await p(n,{...t,user_id:s.id}),A.success("Category updated successfully")):(await f({...t,user_id:s.id}),A.success("Category created successfully")),k({name:"",description:"",color:"#3B82F6"}),u(null)}catch(y){A.error(y.message||"Failed to save category")}},D=t=>{u(t.id),x("name",t.name),x("description",t.description||""),x("color",t.color)},S=()=>{u(null),k({name:"",description:"",color:"#3B82F6"})},L=async t=>{if(window.confirm("Are you sure you want to delete this category? This cannot be undone.")){h(t);try{await g(t)}finally{h(null)}}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:n?"Edit Category":"Create New Category"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n?"Update the details of this expense category":"Add a new category to organize your expenses"})]}),e.jsx("form",{onSubmit:c(B),className:"p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),e.jsx("input",{type:"text",id:"name",className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${N.name?"border-red-300":"border-gray-300"}`,placeholder:"e.g., Office Supplies, Software Subscriptions",...b("name",{required:"Category name is required"})}),N.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",id:"description",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Brief description of this category",...b("description")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",id:"color",className:"h-8 w-8 border border-gray-300 rounded-md cursor-pointer",...b("color")}),e.jsx("input",{type:"text",className:"block w-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",...b("color")})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:j.map(t=>e.jsx("button",{type:"button",className:"w-6 h-6 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",style:{backgroundColor:t},onClick:()=>x("color",t),"aria-label":`Select color ${t}`},t))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[n&&e.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-70",children:m?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"h-4 w-4 mr-2 rounded-full border-2 border-white/30 border-t-white animate-spin"}),"Saving..."]}):n?"Update Category":"Add Category"})]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-3",children:"Your Categories"}),o.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No categories found. Create your first category above."}):e.jsx("ul",{className:"divide-y divide-gray-200 bg-white rounded-md border border-gray-200",children:o.map(t=>e.jsxs("li",{className:"p-3 flex items-center justify-between hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:t.color},children:e.jsx(M,{className:"h-3 w-3 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-gray-500",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>D(t),className:"text-gray-400 hover:text-blue-600 p-1 rounded-full hover:bg-blue-50 transition-colors",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs("button",{type:"button",onClick:()=>L(t.id),disabled:C===t.id,className:"text-gray-400 hover:text-red-600 p-1 rounded-full hover:bg-red-50 transition-colors",children:[C===t.id?e.jsx("div",{className:"h-4 w-4 border-2 border-red-600/30 border-t-red-600 rounded-full animate-spin"}):e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})]},t.id))})]})]})},ve=()=>{const{user:s}=$(),{expenses:o,categories:f,loading:p,error:g,fetchExpenses:d,fetchCategories:m,deleteExpense:n}=O(),[u,C]=i.useState(""),[h,b]=i.useState("all"),[c,k]=i.useState("all"),[x,N]=i.useState("date-desc"),[j,B]=i.useState([]),[D,S]=i.useState(!1),[L,t]=i.useState(!1),[y,G]=i.useState({inr:0,usd:0});i.useEffect(()=>{s&&(d(s.id),m(s.id))},[s,d,m]),i.useEffect(()=>{if(o){let a=[...o];if(u){const r=u.toLowerCase();a=a.filter(l=>{var E,F,w,R,_,P;return l.description.toLowerCase().includes(r)||((E=l.notes)==null?void 0:E.toLowerCase().includes(r))||((F=l.category)==null?void 0:F.name.toLowerCase().includes(r))||((R=(w=l.client)==null?void 0:w.name)==null?void 0:R.toLowerCase().includes(r))||((P=(_=l.client)==null?void 0:_.company_name)==null?void 0:P.toLowerCase().includes(r))})}if(h!=="all"&&(a=a.filter(r=>r.category_id===h)),c!=="all"){const r=new Date,l=new Date;c==="this-month"?l.setDate(1):c==="last-month"?(l.setMonth(r.getMonth()-1,1),r.setDate(0)):c==="this-year"?l.setMonth(0,1):c==="last-30"?l.setDate(r.getDate()-30):c==="last-90"&&l.setDate(r.getDate()-90);const E=l.toISOString().split("T")[0],F=r.toISOString().split("T")[0];a=a.filter(w=>w.date>=E&&w.date<=F)}switch(x){case"date-desc":a.sort((r,l)=>new Date(l.date).getTime()-new Date(r.date).getTime());break;case"date-asc":a.sort((r,l)=>new Date(r.date).getTime()-new Date(l.date).getTime());break;case"amount-desc":a.sort((r,l)=>l.amount-r.amount);break;case"amount-asc":a.sort((r,l)=>r.amount-l.amount);break}B(a);const J=a.reduce((r,l)=>(l.currency==="INR"?r.inr+=l.amount:r.usd+=l.amount,r),{inr:0,usd:0});G(J)}},[o,u,h,c,x]);const H=async()=>{s&&(S(!0),await d(s.id),setTimeout(()=>S(!1),800))},W=async a=>{await n(a)};return p&&!o.length?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"loader h-12 w-12"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-accent-600 to-accent-500",children:"Expenses"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(v,{to:"/expenses/new",className:"w-full sm:w-auto btn btn-primary btn-md",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Add Expense"]}),e.jsxs(v,{to:"/expenses/reports",className:"w-full sm:w-auto btn btn-secondary btn-md",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Reports & Analysis"]}),e.jsxs("button",{onClick:()=>t(!0),className:"w-full sm:w-auto btn btn-secondary btn-md",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Manage Categories"]})]})]}),g&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl animate-fade-in",children:g}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("div",{className:"p-4 border-b border-neutral-200/70",children:e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-4 md:gap-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(re,{className:"h-4 w-4 text-neutral-400 group-focus-within:text-accent-500 transition-colors duration-150"})}),e.jsx("input",{type:"text",className:"form-input pl-10 w-full",placeholder:"Search expenses...",value:u,onChange:a=>C(a.target.value)})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(M,{className:"h-4 w-4 text-neutral-400 group-focus-within:text-accent-500 transition-colors duration-150"})}),e.jsxs("select",{className:"form-select pl-10 w-full",value:h,onChange:a=>b(a.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),f.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"h-4 w-4 text-neutral-400 group-focus-within:text-accent-500 transition-colors duration-150"})}),e.jsxs("select",{className:"form-select pl-10 w-full",value:c,onChange:a=>k(a.target.value),children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"this-month",children:"This Month"}),e.jsx("option",{value:"last-month",children:"Last Month"}),e.jsx("option",{value:"this-year",children:"This Year"}),e.jsx("option",{value:"last-30",children:"Last 30 Days"}),e.jsx("option",{value:"last-90",children:"Last 90 Days"})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(le,{className:"h-4 w-4 text-neutral-400 group-focus-within:text-accent-500 transition-colors duration-150"})}),e.jsxs("select",{className:"form-select pl-10 w-full",value:x,onChange:a=>N(a.target.value),children:[e.jsx("option",{value:"date-desc",children:"Date (Newest first)"}),e.jsx("option",{value:"date-asc",children:"Date (Oldest first)"}),e.jsx("option",{value:"amount-desc",children:"Amount (Highest first)"}),e.jsx("option",{value:"amount-asc",children:"Amount (Lowest first)"})]})]})]})}),e.jsx("div",{className:"p-4 bg-gray-50 border-b border-neutral-200/70",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[j.length," expense",j.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[y.inr>0&&e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-neutral-500",children:"INR:"})," ",I(y.inr,"INR")]}),y.usd>0&&e.jsxs("div",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-neutral-500",children:"USD:"})," ",I(y.usd,"USD")]}),e.jsxs("button",{onClick:H,className:"btn btn-secondary btn-sm",disabled:D,children:[e.jsx(Q,{className:`h-4 w-4 ${D?"animate-spin":""}`}),e.jsx("span",{className:"ml-1.5",children:"Refresh"})]})]})]})})]}),j.length>0?e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:j.map(a=>e.jsx(ie,{expense:a,onDelete:W},a.id))})}):e.jsxs("div",{className:"card p-5 sm:p-6 text-center animate-fade-in",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-neutral-100 flex items-center justify-center text-neutral-400",children:e.jsx(T,{className:"h-8 w-8"})})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-neutral-900",children:"No expenses found"}),e.jsx("p",{className:"mt-2 text-sm text-neutral-500 max-w-md mx-auto",children:o.length>0?"No expenses match your search criteria. Try adjusting your filters.":"Get started by adding your first expense."}),o.length===0&&e.jsx("div",{className:"mt-6",children:e.jsxs(v,{to:"/expenses/new",className:"btn btn-primary btn-md",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Add Expense"]})})]}),L&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>t(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:e.jsxs("button",{type:"button",className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>t(!1),children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),e.jsx(oe,{}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>t(!1),children:"Close"})})]})]})})]})};export{ve as default};
