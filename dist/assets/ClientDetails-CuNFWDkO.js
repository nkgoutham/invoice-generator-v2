import{c as x,d as S,u as P,a as _,r as l,j as e,L as n,f as p}from"./index-DMTdQ3St.js";import{u as j}from"./clientStore-Bedc05g4.js";import{u as A}from"./expenseStore-BpTe1G7s.js";import{f as d}from"./helpers-kgrKKtTT.js";import{A as B}from"./arrow-left-DgZupmuo.js";import{B as L}from"./building-BwG9NAGn.js";import{M as D}from"./mail-CvfNZUA1.js";import{P as R}from"./phone-dzjgbDSA.js";import{C as m}from"./credit-card-CVK1R5mv.js";import{B as N}from"./briefcase-Cm4uPyTN.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=x("FilePlus",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"12",x2:"12",y1:"18",y2:"12",key:"1tsf04"}],["line",{x1:"9",x2:"15",y1:"15",y2:"15",key:"110plj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=x("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=x("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=x("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Q=()=>{const{id:s}=S(),{user:o}=P(),v=_(),{getClient:g,deleteClient:b,fetchEngagementModel:f,loading:w}=j(),{expenses:h,fetchExpenses:u}=A(),[i,k]=l.useState(null),[a,E]=l.useState(null),[c,C]=l.useState([]);if(l.useEffect(()=>{s&&(async()=>{const r=await g(s);r&&k(r)})()},[s,g]),l.useEffect(()=>{o&&u(o.id)},[o,u]),l.useEffect(()=>{if(s&&h.length>0){const t=h.filter(r=>r.client_id===s);C(t)}},[s,h]),l.useEffect(()=>{s&&(async()=>{try{await f(s);const r=await j.getState().engagementModel;E(r)}catch(r){console.error("Error fetching engagement model:",r)}})()},[s,f]),w||!i)return e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});const z=t=>{switch(t){case"retainership":return"Retainership";case"project":return"Project Based";case"milestone":return"Milestone Based";case"service":return"Service Based";default:return"Not Set"}},M=t=>{if(!t)return"Not Set";switch(t){case"onboarding":return"New";case"active":return"Active";case"project":return"Project-based";case"retainer":return"Retainer";case"completed":return"Completed";case"inactive":return"Inactive";default:return t.charAt(0).toUpperCase()+t.slice(1)}};return e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(n,{to:"/clients",className:"text-gray-500 hover:text-gray-700 mr-4",children:e.jsx(B,{size:20})}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:i.name})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(n,{to:`/clients/${s}/edit`,className:"flex flex-col items-center justify-center py-2 px-1 sm:py-3 sm:px-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-center shadow-sm",children:[e.jsx($,{size:16,className:"mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to delete this client?")&&(b(s),v("/clients"))},className:"flex flex-col items-center justify-center py-2 px-1 sm:py-3 sm:px-2 bg-red-500 text-white rounded-md hover:bg-red-600 text-center shadow-sm",children:[e.jsx(T,{size:16,className:"mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Delete"})]}),e.jsxs(n,{to:`/invoices/new?client=${s}`,className:"flex flex-col items-center justify-center py-2 px-1 sm:py-3 sm:px-2 bg-green-500 text-white rounded-md hover:bg-green-600 text-center shadow-sm",children:[e.jsx(y,{size:16,className:"mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"New Invoice"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(L,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Company"}),e.jsx("p",{className:"font-medium",children:i.company_name||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(D,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium truncate",children:i.email||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(R,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium",children:i.phone||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(I,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Billing Address"}),e.jsx("p",{className:"font-medium break-words",children:i.billing_address||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(m,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"GST Number"}),e.jsx("p",{className:"font-medium",children:i.gst_number||"Not specified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(N,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium",children:M(i.engagement_status)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Engagement Details"}),a?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(N,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Engagement Type"}),e.jsx("p",{className:"font-medium",children:z(a.type)})]})]}),a.type==="retainership"&&a.retainer_amount&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(m,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Monthly Retainer"}),e.jsx("p",{className:"font-medium",children:d(a.retainer_amount)})]})]}),a.type==="project"&&a.project_value&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(m,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Project Value"}),e.jsx("p",{className:"font-medium",children:d(a.project_value)})]})]}),a.type==="service"&&a.service_rates&&a.service_rates.length>0&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(m,{className:"text-gray-500 mt-1 flex-shrink-0",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Hourly Rate"}),e.jsxs("p",{className:"font-medium",children:[d(a.service_rates[0].rate)," per ",a.service_rates[0].unit]})]})]})]}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No engagement details found"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Recent Invoices"})}),e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:"No invoices found for this client"}),e.jsxs(n,{to:`/invoices/new?client=${s}`,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Create Invoice"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Billable Expenses"}),e.jsxs(n,{to:`/expenses/new?client=${s}`,className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(p,{className:"mr-1.5 h-3.5 w-3.5"}),"Add Expense"]})]})}),c.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.slice(0,5).map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:t.description}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium",children:d(t.amount,t.currency)})]},t.id))})]}),c.length>5&&e.jsx("div",{className:"px-6 py-3 bg-gray-50 text-center",children:e.jsxs(n,{to:`/expenses?client=${s}`,className:"text-sm text-blue-600 hover:text-blue-800",children:["View all ",c.length," expenses"]})})]}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(p,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No billable expenses"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add expenses that can be billed to this client."}),e.jsx("div",{className:"mt-6",children:e.jsxs(n,{to:`/expenses/new?client=${s}`,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(p,{className:"mr-2 -ml-1 h-5 w-5"}),"Add Billable Expense"]})})]})]})]})]})};export{Q as default};
