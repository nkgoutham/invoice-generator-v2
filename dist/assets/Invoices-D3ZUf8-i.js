import{c as I,u as A,r as l,j as e,L as d,F as u,D as b}from"./index-DMTdQ3St.js";import{u as E}from"./invoiceStore-ACMv2w23.js";import{a as j,f as y}from"./helpers-kgrKKtTT.js";import{P as w}from"./plus-circle-DtCdQUqZ.js";import{S as L}from"./search-DQGV9Rah.js";import{F as T}from"./filter-CpVmvab7.js";import{C as F}from"./calendar-CRwE0Pfy.js";import{E as P,S as M}from"./send-BrKxFpSO.js";import{C as H}from"./clock-BUTmNg2j.js";import{A as U}from"./alert-circle-DEjQuPjF.js";import{C as $}from"./check-circle-HEDH94gZ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=I("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),Y=()=>{const{user:n}=A(),{invoices:r,loading:N,error:x,fetchInvoices:h,updateInvoiceStatus:f}=E(),[i,v]=l.useState(""),[o,_]=l.useState("all"),[m,C]=l.useState("date-desc"),[c,S]=l.useState([]);l.useEffect(()=>{n&&h(n.id)},[n,h]),l.useEffect(()=>{if(r&&n){const s=new Date;s.setHours(0,0,0,0),r.forEach(t=>{const a=new Date(t.due_date);a.setHours(0,0,0,0),(t.status==="sent"||t.status==="partially_paid")&&a<s&&f(t.id,"overdue")})}},[r,n,f]),l.useEffect(()=>{if(r){let s=[...r];if(i){const t=i.toLowerCase();s=s.filter(a=>{var p,g;return a.invoice_number.toLowerCase().includes(t)||((p=a.clients)==null?void 0:p.name)&&a.clients.name.toLowerCase().includes(t)||((g=a.clients)==null?void 0:g.company_name)&&a.clients.company_name.toLowerCase().includes(t)})}switch(o!=="all"&&(s=s.filter(t=>t.status===o)),m){case"date-desc":s.sort((t,a)=>new Date(a.issue_date).getTime()-new Date(t.issue_date).getTime());break;case"date-asc":s.sort((t,a)=>new Date(t.issue_date).getTime()-new Date(a.issue_date).getTime());break;case"amount-desc":s.sort((t,a)=>a.total-t.total);break;case"amount-asc":s.sort((t,a)=>t.total-a.total);break}S(s)}},[r,i,o,m]);const k={draft:"bg-gray-100 text-gray-800",sent:"bg-blue-100 text-blue-800",paid:"bg-green-100 text-green-800",overdue:"bg-red-100 text-red-800",partially_paid:"bg-yellow-100 text-yellow-800"},D=s=>{switch(s){case"paid":return e.jsx($,{className:"h-4 w-4 mr-1.5"});case"overdue":return e.jsx(U,{className:"h-4 w-4 mr-1.5"});case"sent":return e.jsx(H,{className:"h-4 w-4 mr-1.5"});case"partially_paid":return e.jsx(b,{className:"h-4 w-4 mr-1.5"});default:return e.jsx(u,{className:"h-4 w-4 mr-1.5"})}};return N&&!r.length?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"px-4 sm:px-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Invoices"}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:e.jsxs(d,{to:"/invoices/new",className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"New Invoice"]})})]}),x&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:x}),e.jsx("div",{className:"bg-white shadow rounded-lg mb-4 sm:mb-6",children:e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search invoices...",value:i,onChange:s=>v(s.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:o,onChange:s=>_(s.target.value),children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"partially_paid",children:"Partially Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(B,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"date-desc",children:"Date (Newest first)"}),e.jsx("option",{value:"date-asc",children:"Date (Oldest first)"}),e.jsx("option",{value:"amount-desc",children:"Amount (Highest first)"}),e.jsx("option",{value:"amount-asc",children:"Amount (Lowest first)"})]})]}),e.jsxs("div",{className:"flex items-center justify-start lg:justify-center",children:[e.jsx(u,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[c.length," invoice",c.length!==1?"s":""]})]})]})})}),c.length>0?e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:c.map(s=>{var t,a;return e.jsx("li",{children:e.jsx("div",{className:"block hover:bg-gray-50",children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate mr-2",children:s.invoice_number}),e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 text-xs leading-5 font-semibold rounded-full ${k[s.status]||"bg-gray-100 text-gray-800"}`,children:[D(s.status),e.jsx("span",{className:"hidden sm:inline",children:s.status==="partially_paid"?"Partially Paid":s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(F,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"truncate mr-2 hidden sm:inline",children:j(s.issue_date)}),e.jsx("span",{className:"truncate sm:ml-2 sm:mr-2 hidden sm:inline",children:"â€¢"}),e.jsxs("span",{className:"truncate",children:["Due: ",j(s.due_date)]})]})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"flex items-center text-sm text-gray-500",children:e.jsxs("span",{className:"truncate",children:["Client:",e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:((t=s.clients)==null?void 0:t.company_name)||((a=s.clients)==null?void 0:a.name)||"Client"})]})}),e.jsxs("div",{className:"mt-2 flex items-center text-sm sm:mt-0",children:[e.jsx(b,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:y(s.total,s.currency)}),s.status==="partially_paid"&&s.partially_paid_amount!==void 0&&e.jsxs("span",{className:"ml-1 text-xs text-green-600",children:["(",y(s.partially_paid_amount,s.currency)," paid)"]})]})]}),e.jsxs("div",{className:"mt-2 flex justify-end",children:[e.jsxs(d,{to:`/invoices/${s.id}/view`,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 mr-2",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(P,{className:"mr-1 h-4 w-4"}),"View Invoice"]}),s.status==="draft"&&e.jsxs(d,{to:`/invoices/${s.id}`,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e.jsx(M,{className:"mr-1 h-4 w-4"}),"Manage"]})]})]})})},s.id)})})}):e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx(u,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No invoices found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r.length>0?"No invoices match your search criteria. Try adjusting your filters.":"Get started by creating your first invoice."}),r.length===0&&e.jsx("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-center",children:e.jsxs(d,{to:"/invoices/new",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Create Invoice"]})})]})]})};export{Y as default};
