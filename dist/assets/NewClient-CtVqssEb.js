import{a as N,u as C,r as d,j as e,g as m}from"./index-DMTdQ3St.js";import{u as w}from"./clientStore-Bedc05g4.js";import{e as F}from"./helpers-kgrKKtTT.js";const E=()=>{const g=N(),{createClient:h,createEngagementModel:f}=w(),{user:x}=C(),[n,i]=d.useState({name:"",company_name:"",billing_address:"",gst_number:"",contact_person:"",email:"",phone:"",status:"active",engagement_status:"active"}),[s,c]=d.useState({type:"service",retainer_amount:"",project_value:"",service_rates:[{name:"Hourly Rate",rate:0,unit:"hour",currency:"INR"}]}),[p,b]=d.useState(!1),o=r=>{const{name:t,value:a}=r.target;i(l=>({...l,[t]:a}))},y=r=>{c(t=>({...t,type:r.target.value})),r.target.value==="retainership"?i(t=>({...t,engagement_status:"retainer"})):r.target.value==="project"?i(t=>({...t,engagement_status:"project"})):i(t=>({...t,engagement_status:"active"}))},u=r=>{const{name:t,value:a}=r.target;if(t==="retainer_amount"||t==="project_value")c(l=>({...l,[t]:a}));else if(t==="hourly_rate"){const l=[...s.service_rates];l[0]={...l[0],rate:parseFloat(a)||0},c(_=>({..._,service_rates:l}))}},v=r=>{const t=r.target.value,a=[...s.service_rates];a[0]={...a[0],currency:t},c(l=>({...l,service_rates:a}))},j=async r=>{if(r.preventDefault(),!n.name.trim()){m.error("Client name is required");return}if(!x){m.error("User not authenticated");return}b(!0);try{const t=await h({...n,user_id:x.id});if(t){const a={client_id:t.id,type:s.type,retainer_amount:s.type==="retainership"&&parseFloat(s.retainer_amount)||null,project_value:s.type==="project"&&parseFloat(s.project_value)||null,service_rates:s.type==="service"?s.service_rates:null};await f(a),m.success("Client created successfully"),g("/clients")}}catch(t){console.error("Error adding client:",t),m.error("Failed to create client")}finally{b(!1)}};return e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 py-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900",children:"Add New Client"}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("form",{onSubmit:j,className:"p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",id:"company_name",name:"company_name",value:n.company_name,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"contact_person",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),e.jsx("input",{type:"text",id:"contact_person",name:"contact_person",value:n.contact_person,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"text",id:"phone",name:"phone",value:n.phone,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing_address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Billing Address"}),e.jsx("textarea",{id:"billing_address",name:"billing_address",value:n.billing_address,onChange:o,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gst_number",className:"block text-sm font-medium text-gray-700 mb-1",children:"GST Number"}),e.jsx("input",{type:"text",id:"gst_number",name:"gst_number",value:n.gst_number,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Status"}),e.jsxs("select",{id:"status",name:"status",value:n.status,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"prospect",children:"Prospect"})]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h2",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4",children:"Engagement Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"engagement_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Engagement Type *"}),e.jsx("select",{id:"engagement_type",name:"engagement_type",value:s.type,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:F.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),s.type==="retainership"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retainer_amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Retainer Amount"}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex items-center justify-center bg-gray-100 px-3 border border-r-0 border-gray-300 rounded-l-md",children:"₹"}),e.jsx("input",{type:"number",id:"retainer_amount",name:"retainer_amount",value:s.retainer_amount,onChange:u,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),s.type==="project"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_value",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Value"}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex items-center justify-center bg-gray-100 px-3 border border-r-0 border-gray-300 rounded-l-md",children:"₹"}),e.jsx("input",{type:"number",id:"project_value",name:"project_value",value:s.project_value,onChange:u,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),s.type==="service"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"hourly_rate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Hourly Rate"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"flex col-span-3",children:[e.jsxs("select",{id:"rate_currency",name:"rate_currency",className:"flex items-center justify-center bg-gray-100 px-3 border border-r-0 border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",value:s.service_rates[0].currency||"INR",onChange:v,children:[e.jsx("option",{value:"INR",children:"₹"}),e.jsx("option",{value:"USD",children:"$"})]}),e.jsx("input",{type:"number",id:"hourly_rate",name:"hourly_rate",value:s.service_rates[0].rate,onChange:u,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsx("div",{className:"text-gray-500 flex items-center text-sm",children:"per hour"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>g("/clients"),className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-70",children:p?"Saving...":"Save Client"})]})]})})})]})};export{E as default};
